{"version":3,"sources":["webpack:///webpack/bootstrap be735bad4297b02698c6","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///./server/api/services/search.service.ts","webpack:///./server/index.ts","webpack:///./server/common/env.ts","webpack:///external \"dotenv\"","webpack:///./server/common/server.ts","webpack:///external \"express-async-errors\"","webpack:///external \"body-parser\"","webpack:///external \"http\"","webpack:///external \"os\"","webpack:///external \"cors\"","webpack:///external \"cookie-parser\"","webpack:///./server/common/swagger/index.ts","webpack:///./server/common/logger.ts","webpack:///external \"pino\"","webpack:///./server/api/services/messaging.service.ts","webpack:///external \"amqplib\"","webpack:///external \"events\"","webpack:///external \"elasticsearch\"","webpack:///./server/api/services/entitiy-type.ts","webpack:///./server/api/middleware/cors.ts","webpack:///./server/routes.ts","webpack:///./server/api/controllers/search/router.ts","webpack:///./server/api/controllers/search/controller.ts","webpack:///./server/api/controllers/search/entitiy-schema.ts","webpack:///./server/api/controllers/search/event-schema.ts","webpack:///./server/api/controllers/search/campaign-schema.ts","webpack:///./server/api/controllers/search/organization-schema.ts","webpack:///./server/api/middleware/input-validation.ts","webpack:///external \"jsonschema\""],"names":[],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap be735bad4297b02698c6","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 1\n// module chunks = 0","import * as es from 'elasticsearch';\nimport { EntityType } from './entitiy-type';\n\nclass SearchService {\n\n    private client;\n    private indexName = 'volunteero-search';\n    constructor(host: String) {\n\n        this.client = new es.Client({\n            host,\n            log: 'trace'\n        });\n    }\n\n    private createEsParams(entities, mode: EntityType) {\n\n        let body = [];\n        entities.forEach(entity => {\n\n            let moddedPush = {};\n            moddedPush[mode] = { _index: this.indexName, _type: 'default', _id: entity.id };\n            body.push(moddedPush);\n\n            switch (mode) {\n                case EntityType.Create:\n                    body.push(entity);\n                    break;\n                case EntityType.Update:\n                    body.push({ doc: entity });\n                    break;\n            }\n        });\n        return { body };\n    }\n\n    async createEntities(entities) {\n\n        return await this.client.bulk(this.createEsParams(entities, EntityType.Create));\n    }\n\n    async updateEntities(entities) {\n\n        return await this.client.bulk(this.createEsParams(entities, EntityType.Update));\n    }\n\n    async deleteEntities(entities) {\n\n        return await this.client.bulk(this.createEsParams(entities, EntityType.Delete));\n    }\n\n    async search(keywords: String[], type = 'any') {\n\n        let typedQuery = false;\n        let q = '';\n        // If there is a preferred entity type, enforce it\n        if (type !== 'any') {\n\n            typedQuery = true;\n            q += `type:${type}`;\n        }\n        // If we have keywords, add each one as filter for name and description\n        if (keywords.length > 0) {\n\n            if (typedQuery) {\n\n                q += ' AND (';\n            }\n            q += keywords.reduce((query, keyword) => {\n                query += ` description:${keyword} OR name:${keyword} OR`;\n                return query;\n            }, '');\n            q = q.substring(0, q.length - 3);\n            if (typedQuery) {\n\n                q += ')';\n            }\n        }\n        // Do the search\n        const result = await this.client.search({\n            index: this.indexName,\n            q\n        });\n        // Sort and split\n        const sortedAndCleaned = { events: [], campaigns: [], organizations: [] };\n        result.hits.hits\n            .sort((a, b) => a._score > b._score)\n            .map((hit) => hit._source)\n            .forEach(entity => {\n\n                switch (entity.type) {\n                    case 'event':\n                    case 'organization':\n                    case 'campaign':\n                        let copy = { ...entity };\n                        delete copy.type;\n                        sortedAndCleaned[entity.type + 's'].push(copy);\n                        break;\n                }\n\n            });\n        return sortedAndCleaned;\n    }\n}\n\nexport default new SearchService('http://ec2-52-59-87-68.eu-central-1.compute.amazonaws.com:9200');\n\n\n// WEBPACK FOOTER //\n// ./server/api/services/search.service.ts","import './common/env';\nimport Server from './common/server';\nimport routes from './routes';\n\nconst port = parseInt(process.env.PORT);\nexport default new Server()\n  .router(routes)\n  .listen(port);\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.ts","import * as dotenv from 'dotenv';\ndotenv.config();\n\n\n// WEBPACK FOOTER //\n// ./server/common/env.ts","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 6\n// module chunks = 0","require('express-async-errors');\n\nimport * as express from 'express';\nimport { Application } from 'express';\nimport * as path from 'path';\nimport * as bodyParser from 'body-parser';\nimport * as http from 'http';\nimport * as os from 'os';\nimport * as cors from 'cors';\nimport * as cookieParser from 'cookie-parser';\nimport swaggerify from './swagger';\nimport l from './logger';\nimport MessagingService from '../api/services/messaging.service';\nimport SearchService from '../api/services/search.service';\nimport { corsMiddleware } from '../api/middleware/cors';\n\nconst app = express();\n\nexport default class ExpressServer {\n\n  constructor() {\n    const root = path.normalize(__dirname + '/../..');\n    app.set('appPath', root + 'client');\n    app.use(\n      cors((req, callback) => {\n        callback(null, {\n          origin: true,\n          credentials: true\n        });\n      }),\n    );\n    app.use(corsMiddleware);\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({ extended: true }));\n    app.use(cookieParser(process.env.SESSION_SECRET));\n    app.use(express.static(`${root}/public`));\n\n\n    MessagingService.on('ready', () => {\n\n      function getMessagePayload(message) {\n\n        try {\n\n          let response = JSON.parse(message.content.toString());\n          return response.entities || [];\n        } catch (e) {\n\n          return [];\n        }\n      }\n\n      async function handleMessage(ch, message, operationType) {\n\n        try {\n          \n          let payload = getMessagePayload(message);\n          switch (operationType) {\n\n            case 'create':\n              await SearchService.createEntities(payload);\n              break;\n            case 'update':\n              await SearchService.updateEntities(payload);\n              break;\n            case 'delete':\n              await SearchService.deleteEntities(payload);\n              break;\n          }\n        } finally {\n\n          ch.ack(message);\n        }\n\n      }\n\n      MessagingService.subscribeToQueue('search.create', async (ch, message) => {\n\n        await handleMessage(ch, message, 'create');\n      });\n      MessagingService.subscribeToQueue('search.update', async (ch, message) => {\n\n        await handleMessage(ch, message, 'update');\n      });\n      MessagingService.subscribeToQueue('search.delete', async (ch, message) => {\n\n        await handleMessage(ch, message, 'delete');\n      });\n    })\n  }\n\n  router(routes: (app: Application) => void): ExpressServer {\n    swaggerify(app, routes);\n    return this;\n  }\n\n  listen(port: number = parseInt(process.env.PORT)): Application {\n    const welcome = port => () => l.info(`up and running in ${process.env.NODE_ENV || 'development'} @: ${os.hostname()} on port: ${port}}`);\n    http.createServer(app).listen(port, welcome(port));\n    return app;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/common/server.ts","module.exports = require(\"express-async-errors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-async-errors\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"os\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"os\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 13\n// module chunks = 0","import * as middleware from 'swagger-express-middleware';\nimport { Application } from 'express';\nimport * as path from 'path';\n\nexport default function (app: Application, routes: (app: Application) => void) {\n  routes(app);\n  // middleware(path.join(__dirname, 'Api.yaml'), app, function(err, middleware) {\n\n  //   // Enable Express' case-sensitive and strict options\n  //   // (so \"/entities\", \"/Entities\", and \"/Entities/\" are all different)\n  //   app.enable('case sensitive routing');\n  //   app.enable('strict routing');\n\n  //   app.use(middleware.metadata());\n  //   app.use(middleware.files(app, {\n  //     apiPath: process.env.SWAGGER_API_SPEC,\n  //   }));\n\n  //   app.use(middleware.parseRequest({\n  //     // Configure the cookie parser to use secure cookies\n  //     cookie: {\n  //       secret: process.env.SESSION_SECRET\n  //     },\n  //     // Don't allow JSON content over 100kb (default is 1mb)\n  //     // json: {\n  //     //   limit: process.env.REQUEST_LIMIT\n  //     // }\n  //   }));\n\n  //   // These two middleware don't have any options (yet)\n  //   app.use(\n  //     middleware.CORS(),\n  //     middleware.validateRequest());\n\n  //   // Error handler to display the validation error as HTML\n  //   // app.use(function (err, req, res, next) {\n\n  //   //   res.status(err.status || 400).json({\n  //   //     status: err.status,\n  //   //     message: err.message.split('\\n').join(' ')\n  //   //   });\n  //   // });\n\n  //   routes(app);\n  // });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/common/swagger/index.ts","import * as pino from 'pino';\n\nconst l = pino({\n  name: process.env.APP_ID || 'SearchService',\n  level: process.env.LOG_LEVEL || 'trace',\n});\n\nexport default l;\n\n\n\n// WEBPACK FOOTER //\n// ./server/common/logger.ts","module.exports = require(\"pino\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pino\"\n// module id = 17\n// module chunks = 0","import * as amqp from 'amqplib';\nimport * as events from 'events';\n\nclass MessagingService extends events.EventEmitter {\n\n    private readConnection;\n    private writeConnection;\n    private logging;\n\n    constructor(private amqpUrl: String) {\n\n        super();\n        this.init();\n    }\n\n    public async init() {\n\n        this.readConnection = await amqp.connect(this.amqpUrl);\n        this.writeConnection = await amqp.connect(this.amqpUrl);\n        this.emit('ready')\n    }\n\n    async sendMessage(message: any, exchangeName: String, routingKey: String) {\n\n        if (this.logging) {\n\n\n            console.log('\\n------------------------------\\n');\n            console.log(`Sending to ${exchangeName}:${routingKey}`);\n        }\n\n        const channel = await this.writeConnection.createChannel();\n        await channel.publish(exchangeName, routingKey, new Buffer(JSON.stringify(message)));\n    }\n\n    async subscribeToQueue(queueName, subscriber) {\n\n        const channel = await this.writeConnection.createChannel();\n        channel.consume(queueName, (message) => {\n\n            if (this.logging) {\n\n                const payload = JSON.parse(message.content.toString());\n                console.log(`Got message at queue ${queueName} from ${message.fields.exchange} with routing key ${message.fields.routingKey}`);\n                console.log(payload);\n            }\n            subscriber(channel, message);\n        });\n    }\n\n    public setLogging(enabled: boolean) {\n\n        this.logging = enabled;\n    }\n}\n\nexport default new MessagingService('amqp://qgoudwsq:vylnIAdpecjvnlHBBaq7yREurJXzIWX1@duckbill.rmq.cloudamqp.com/qgoudwsq');\n\n\n// WEBPACK FOOTER //\n// ./server/api/services/messaging.service.ts","module.exports = require(\"amqplib\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"amqplib\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"elasticsearch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"elasticsearch\"\n// module id = 21\n// module chunks = 0","export enum EntityType{\n    Update = \"update\",\n    Create = \"index\",\n    Delete = \"delete\"\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/services/entitiy-type.ts","export function corsMiddleware(req, res, next) {\n\n    res.header('Access-Control-Allow-Origin', req.get('origin'));\n    res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE');\n    res.header('Access-Control-Allow-Headers', 'Content-Type');\n\n    next();\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/middleware/cors.ts","import { Application } from 'express';\nimport searchRouter from './api/controllers/search/router';\nexport default function routes(app: Application): void {\n  app.use('/api/v1/search', searchRouter);\n};\n\n\n// WEBPACK FOOTER //\n// ./server/routes.ts","import * as express from 'express';\nimport controller from './controller'\nimport entitiySchema from './entitiy-schema';\nimport { validateInput, ValidationScope } from '../../middleware/input-validation';\nexport default express.Router()\n    .get('/', controller.search)\n    .post('/create', validateInput(entitiySchema, ValidationScope.Body), controller.create)\n    .post('/update', validateInput(entitiySchema, ValidationScope.Body), controller.update)\n    .post('/delete', validateInput(entitiySchema, ValidationScope.Body), controller.delete);\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/search/router.ts","import { Request, Response } from 'express';\nimport MessagingService from '../../services/messaging.service';\nimport SearchService from '../../services/search.service';\n\nexport class Controller {\n\n  public static allowedTypes = ['event', 'campaign', 'organization', 'any'];\n  async search(req: Request, res: Response) {\n\n    const isValidInput = Controller.isValidInput(req.query);\n    if (!isValidInput.valid) {\n\n      return res.status(400).json({\n        message: 'Invalid input: ' + isValidInput.reason,\n        allowedType: Controller.allowedTypes.join(', ')\n      })\n    }\n\n    const keywords = req.query.keyword.split(' ');\n    const searchResult = await SearchService.search(keywords, req.query.type);\n    return res.status(200).json({ ...searchResult });\n  }\n\n  async create(req: Request, res: Response) {\n\n    const result = await SearchService.createEntities(req.body.entities);\n    if (result.error) {\n\n      return res.status(400).json({ errors: result.errors });\n    }\n    return res.status(200).json({ success: true });\n  }\n\n  async update(req: Request, res: Response) {\n\n    const result = await SearchService.updateEntities(req.body.entities);\n    if (result.error) {\n\n      return res.status(400).json({ errors: result.errors });\n    }\n    return res.status(200).json({ success: true });\n  }\n\n  async delete(req: Request, res: Response) {\n\n    const result = await SearchService.deleteEntities(req.body.entities);\n    if (result.error) {\n\n      return res.status(400).json({ errors: result.errors });\n    }\n    return res.status(200).json({ success: true });\n  }\n\n  static isValidInput(query: any = {}): { valid: boolean, reason?: string } {\n\n    if (typeof query.type === 'undefined') {\n\n      return {\n        valid: false,\n        reason: 'No type specified'\n      };\n    }\n    if (typeof query.keyword === 'undefined') {\n\n      return {\n        valid: false,\n        reason: 'No keyword specified'\n      };\n    }\n    if (this.allowedTypes.indexOf(query.type) < 0) {\n\n      return {\n        valid: false,\n        reason: 'Type not supported'\n      };\n    }\n\n    return {\n      valid: true\n    };\n  }\n\n}\nexport default new Controller();\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/search/controller.ts","import eventSchema from \"./event-schema\";\r\nimport campaignSchema from \"./campaign-schema\";\r\nimport organizationSchema from \"./organization-schema\";\r\n\r\nexport default {\r\n    id: 'identity',\r\n    type: 'object',\r\n    properties: {\r\n        entities: {\r\n            type: 'array',\r\n            items: {\r\n                anyOf: [\r\n                    eventSchema,\r\n                    campaignSchema,\r\n                    organizationSchema\r\n                ],\r\n                minItems: 1\r\n            }\r\n        }\r\n    },\r\n    required: ['entities']\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/search/entitiy-schema.ts","export default {\r\n    id: 'event',\r\n    type: 'object',\r\n    properties:{\r\n        id: { type: 'string' },\r\n        name: { type: 'string' },\r\n        description: { type: 'string' },\r\n        start: { type: 'string' },\r\n        end: { type: 'string' },\r\n        location: { type: 'string' },\r\n        category: { type: 'string' },\r\n        organization_id: { type: 'string' },\r\n        points: { type: 'number' },\r\n        volunteers: { type: 'number' },\r\n        available: { type: 'boolean' },\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/search/event-schema.ts","export default {\r\n    id: 'campaign',\r\n    type: 'object',\r\n    properties:{\r\n        name: { type: 'string' },\r\n        description: { type: 'string' },\r\n        id: { type: 'string' },\r\n        influencePoints: { type: 'string' },\r\n        organizationId: { type: 'number' },\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/search/campaign-schema.ts","export default {\r\n    id: 'organization',\r\n    type: 'object',\r\n    properties: {\r\n        id: { type: 'string' },\r\n        user_id: { type: 'string' },\r\n        organization_name: { type: 'string' },\r\n        organization_description: { type: 'string' },\r\n        influencePoints: {\r\n            type: 'array',\r\n            items: {\r\n                type: 'string'\r\n            }\r\n        },\r\n        campaign_ids: {\r\n            type: 'array',\r\n            items: {\r\n                type: 'string'\r\n            }\r\n        },\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/search/organization-schema.ts","import { Request, Response } from 'express';\r\nimport { Validator, Schema, ValidatorResult, validate } from 'jsonschema';\r\n\r\nexport function validateInput(schema: Schema, scope: ValidationScope = ValidationScope.Body) {\r\n\r\n    return function corsMiddleware(req: Request, res: Response, next) {\r\n\r\n        let result= validate(req.body, schema);\r\n        if (!result.valid) {\r\n\r\n            return res.status(400).json({ errors: result });\r\n        }\r\n\r\n        next();\r\n    };\r\n}\r\n\r\nexport enum ValidationScope {\r\n    Body, Query\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/middleware/input-validation.ts","module.exports = require(\"jsonschema\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonschema\"\n// module id = 33\n// module chunks = 0"],"sourceRoot":""}